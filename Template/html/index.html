<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forum</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <link rel="stylesheet" href="../Template/css/style.css" />
  </head>

  <body>
    <!-- Navbar -->
    {{if eq .User.Status "Connected"}}
    <nav class="navbar">
      <div class="user-info">
        <button class="log-btn">
          <i class="fa-solid fa-user"></i> {{.User.Username}}
        </button>
        <button class="log-btn" id="logout">Logout</button>
      </div>
    </nav>
    {{end}}

    <div class="main-container">
      <!-- Sidebar -->
      {{if eq .User.Status "Connected"}}
      <div class="sidebar">
        <div class="sidebar-header">
          <i class="fas fa-home"></i>
          <span>Forum Navigation</span>
        </div>
        <nav class="sidebar-nav">
          <button
            class="nav-item active"
            id="post-items"
            data-panel="all-posts"
          >
            <i class="fas fa-globe"></i>
            <span>All Posts</span>
          </button>
          <button class="nav-item" data-panel="my-posts">
            <i class="fas fa-user-edit"></i>
            <span>My Posts</span>
          </button>
          <button class="nav-item" data-panel="liked-posts">
            <i class="fas fa-heart"></i>
            <span>Liked Posts</span>
          </button>
          <button class="nav-item" data-panel="create-post">
            <i class="fas fa-plus-circle"></i>
            <span>Create Post</span>
          </button>
          <button class="nav-item" data-panel="chat">
            <i class="fa-solid fa-comments"></i>
            <span>Chat</span>
          </button>
        </nav>
      </div>
      {{end}}

      <!-- Main Content -->
      <div class="main-content">
        {{if ne .User.Status "Connected"}}
        <div class="panel active" id="login-panel">
          <form id="loginForm" method="post">
            <h2>Login</h2>
            <div class="input-field">
              <input type="text" id="username-login" name="username" required />
              <label>Username</label>
              <small id="usernameError" class="error-message"></small>
            </div>
            <div class="input-field">
              <input
                type="password"
                id="password-login"
                name="password"
                required
              />
              <label>Password</label>
              <small id="passwordError" class="error-message"></small>
            </div>
            <button type="submit" id="loginButton">Log In</button>
            <p class="register">
              Don't have an account?
              <button type="button" id="register">Register</button>
            </p>
            <small id="generalError" class="error-message"></small>
          </form>
        </div>

        <div class="panel" id="register-panel">
          <form id="registerForm" method="post">
            <h2>Register</h2>
            <div class="input-field">
              <input type="text" name="username" id="username" required />
              <label>Username</label>
              <small id="usernameError" class="error-message"></small>
            </div>
            <div class="input-field">
              <input type="email" id="email" name="email" required />
              <label>Email Address</label>
              <small id="emailError" class="error-message"></small>
            </div>
            <div class="input-field">
              <input type="password" id="password" name="password" required />
              <label>Create Password</label>
              <small id="passwordError" class="error-message"></small>
            </div>
            <div class="input-field">
              <input
                type="password"
                id="confirmPassword"
                name="confirmPassword"
                required
              />
              <label>Confirm Password</label>
              <small id="confirmPasswordError" class="error-message"></small>
            </div>
            <button type="submit">Register</button>
            <p>
              Already have an account?
              <button type="button" id="login">Login</button>
            </p>
            <small id="generalErrorRegister" class="error-message"></small>
          </form>
        </div>
        {{else}}

        <div class="panel active" id="all-posts">
          {{if .Posts}} {{range .Posts}}
          <div id="post" class="post">
            <div class="post-header">
              <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
                <span class="post-author">{{.Author}}</span>
              </div>
              <span class="post-date">{{.CreatedAt}}</span>
            </div>
            <h3 class="post-title">{{.Title}}</h3>
            <p class="post-content">{{.Content}}</p>
            <div class="category-tags">
              {{range .Categories}}
              <span class="category-tag">#{{.}}</span>
              {{end}}
            </div>
            <div class="post-actions">
              <button id="like-btn-{{.ID}}" class="action-btn">
                <i class="fas fa-thumbs-up"></i>
                <span id="like-count-{{.ID}}">{{.TotalLikes}}</span>
              </button>
              <button id="dislike-btn-{{.ID}}" class="action-btn">
                <i class="fas fa-thumbs-down"></i>
                <span id="dislike-count-{{.ID}}">{{.TotalDislikes}}</span>
              </button>
              <button class="comment-btn" id="show-post-{{.ID}}">
                <i class="fas fa-comment"></i>
                <span id="commentCountBtn">{{.TotalComments}}</span> Comments
              </button>
            </div>
          </div>
          {{end}} {{else}}
          <h3 style="text-align: center">No Posts Available</h3>
          {{end}}
        </div>

        <div class="panel" id="my-posts"></div>

        <div class="panel" id="liked-posts"></div>

        <div class="panel" id="post-comment"></div>

        <div class="panel" id="create-post"></div>

        <div class="panel" id="chat"></div>
        {{end}}
      </div>
    </div>
    <script src="../Template/Script/login.js" type="module"></script>
    <script src="../Template/Script/logout.js"></script>
    <script src="../Template/Script/register.js"></script>
    <script src="../Template/Script/panel.js" type="module"></script>
    <script src="../Template/Script/chat.js"></script>
    <script src="../Template/Script/create_post.js"></script>
    <script src="../Template/Script/create_comment.js"></script>
    <script src="../Template/Script/likes_posts.js"></script>
    <script src="../Template/Script/likes_comments.js"></script>
    <script src="../Template/Script/post.js"></script>
  </body>
</html>
